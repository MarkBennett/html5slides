<!DOCTYPE html>
<html>
  <head>
    <title>Interacting with Web Content using the Mozilla Add-on SDK</title>

    <meta charset='utf-8'>
    <script src="slides.js"></script>
  </head>
    <body style='display: none'>

    <section class='slides layout-regular template-default'>
      
<article>
  <h1>Interacting with <br/>Web Content</h1>
  <h3>Mozilla Add-on SDK Workshop</h3>
</article>

<article>
  <h1>Follow along</h1>
  <h3><a href="http://talks.canuckistani.ca/webcontent-uk-2011">http://talks.canuckistani.ca/webcontent-uk-2011</a></h3>
</article>

<article>
  <h3>Content scripts</h3>
  <ul class="build">
   <li>inject any JavaScript logic into a page:
    <ul>
      <li>inline JS code</li>
      <li>your own scripts and libraries</li>
      <li>3rd party JS libraries such as jQuery</li>
    </ul>
   </li>
   <li>modify the page's DOM</li>
   <li>communicate from the content script back to your add-on code</li>
  </ul>
</article>
   
<article>
  <h3>Hello, world</h3>
  <pre>var pageMod = require("page-mod").PageMod({
  include: ['*'],
  contentScript: 'alert("Heellooooooo, Looondoooon!!!!")',
  contentScriptWhen: 'ready',
});</pre>
  
<div style="margin-top: 0;" class="build">
  <h3>Dissection:</h3>
</div>
  <ul class="build">
    <li><code>include: ['*']</code> which site(s) do we mod?</li>
    <li><code>contentScript</code> JS code to run.</li>
    <li><code>contentScriptWhen: 'ready'</code> when to run the code.</li>
  </ul>
</article>

<article>
  <h3>Content script security model</h3>
  <ul class="build">
    <li><code>window</code> object is actually a proxy to the page's window.</li>
    <li>JS running in the page cannot change anything the content script has access to.</li>
  </ul>
  
<div style="margin-top: 0;" class="build">
  <div>
    <p style="margin: 0 0 20px 0;">Example</p>
    <p>Page script:
      <pre style="margin: 6px 0 20px 0;">window.alert = function(arg) { /* evil code here */ }</pre></p>
    
      <p>Content script:
      <pre style="margin: 6px 0 20px 0;">window.alert("Heellooooooo, Looondoooon!!!!");</pre></p>
    
      <p>Result?</p>
  </div>
</div>

</article>

<article>
  <h3>page-mod</h3>
  <ul class="build">
    <li><code>['*']</code>: target any document loaded</li>
    <li>target very specific urls: <br/><code>['http://canuckistani.ca/some_page.html']</code></li>
    <li>execute on start, ready or end ( default )</li>
    <li>react to when the content scritps are attached</li>
    <li>emit events into your content scripts via a worker</li>
  </ul>
</article>

<article>
  <h3>'Batteries included' example</h3>
  <pre>var pageMod = require("page-mod").PageMod({
    include: ['*.canuckistani.ca'],
    contentScriptWhen: 'end',
    contentScriptFile: [data.url('lib.js')],
    onAttach: function(worker) {
      workers.push(worker);
      worker.on('detach', function () {
        detachWorker(this, workers);
      });
      
      worker.postMessage('42'); 
    }
  });</pre>
  <a target="_blank" href="https://builder.addons.mozilla.org/addon/1015111/latest/">Link</a>
</article>

<article>
  <h3></h3>
  <ul>
    <li></li>
  </ul>
</article>

<article>
  <h3>tabs</h3>
  <ul>
    <li>tabs:
      <ul>
        <li>utilities for opening & closing tabs</li>
        <li>tabs meta-data: title, url, etc.</li>
        <li>react to tab-related events: open, close, ready, activate, deactivate</li>
        <li>content scripts are loaded into the tab's <em>top-level</em> content.</li>
      </ul>
    </li>

  </ul>
</article>

<article>
  <h1>Content script communications</h1>
  <ul>
    <li></li>
  </ul>
</article>

<article>
  <h1>We are all Rocketeers!</h1>
</article>

<article>
  <h3>Get involved, kick the tires, let us know.</h3>
  <ul>
    <li>IRC: #jetpack</li>
    <li><a href="http://groups.google.com/group/mozilla-labs-jetpack">Google Group</a></li>
    <li><a href="https://forums.mozilla.org/addons/viewforum.php?f=27">AMO Forum</a></li>
    <li><a href="https://wiki.mozilla.org/Jetpack#Weekly_Meeting">Weekly project meetings</a></li>
    <li>SDK BOF: Thursday at 3PM - gather at the registration desk.</li>
  </ul>
</article>

</body>
</html>
